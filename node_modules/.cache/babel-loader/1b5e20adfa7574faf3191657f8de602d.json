{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/rapunzel/Documents/tb-admin 2/src/components/DashChart.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useDataProvider, Loading, Error } from 'react-admin';\nimport { ResponsiveContainer, AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip } from 'recharts';\nimport PropTypes from 'prop-types';\n\nfunction getTimestampFirstDayOfKey(datetype) {\n  var date = new Date();\n  date.setDate(1);\n\n  if (datetype === \"month\") {\n    return Math.round(Number(date.valueOf() / 1000));\n  } else {\n    date.setMonth(0);\n    return Math.round(Number(date.valueOf() / 1000));\n  }\n}\n\nconst getDateTime = (value, datetype) => {\n  if (value === undefined) {\n    return \"\";\n  } else {\n    const timestamp = new Date(value === undefined ? new Date() : value * 1000);\n    var year = timestamp.getFullYear();\n    var month = (1 + timestamp.getMonth()).toString();\n    month = month.length > 1 ? month : '0' + month; // return timestamp.toLocaleString();\n\n    if (datetype === \"month\") return timestamp.toLocaleDateString();else return month + \"/\" + year;\n  }\n};\n\nconst DashChart = ({\n  datetype\n}) => {\n  _s();\n\n  const dataProvider = useDataProvider();\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState();\n  useEffect(() => {\n    dataProvider('GET_LIST', 'notifications', {\n      sort: {\n        field: 'report_timestamp',\n        order: 'ASC'\n      },\n      pagination: {\n        page: 1,\n        perPage: 10000000\n      }\n    }).then(({\n      data,\n      total\n    }) => {\n      setData(data);\n      setLoading(false);\n    }).catch(error => {\n      setError(error);\n      setLoading(false);\n    });\n  }, []);\n  var chartData = [];\n  if (loading) return /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 25\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(Error, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 23\n  }, this);\n  var preDate = \"\";\n  data.map(async answer => {\n    if (!data || data.length === 0) {\n      return;\n    }\n\n    if (answer.report_timestamp < getTimestampFirstDayOfKey(datetype)) {\n      return;\n    }\n\n    const selDate = getDateTime(answer.report_timestamp, datetype);\n\n    if (preDate === selDate) {\n      chartData[chartData.length - 1].Notifications += 1;\n    } else {\n      chartData[chartData.length] = {\n        name: selDate,\n        Notifications: 1\n      };\n      preDate = selDate;\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n    height: 250,\n    width: \"99%\",\n    children: /*#__PURE__*/_jsxDEV(AreaChart // width={500} height={400} \n    , {\n      data: chartData,\n      margin: {\n        top: 50,\n        right: 20,\n        bottom: 20,\n        left: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n        strokeDasharray: \"3 3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n        dataKey: \"name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(YAxis, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Area, {\n        type: \"monotone\",\n        dataKey: \"Notifications\",\n        stroke: \"#8884d8\",\n        fill: \"#8884d8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 9\n  }, this);\n};\n\n_s(DashChart, \"S7PghAdV3GrmgPlKgry3kz80CNM=\", false, function () {\n  return [useDataProvider];\n});\n\n_c = DashChart;\nDashChart.propTypes = {\n  datetype: PropTypes.string.isRequired\n};\nexport default DashChart;\n\nvar _c;\n\n$RefreshReg$(_c, \"DashChart\");","map":{"version":3,"sources":["/Users/rapunzel/Documents/tb-admin 2/src/components/DashChart.js"],"names":["React","useState","useEffect","useDataProvider","Loading","Error","ResponsiveContainer","AreaChart","Area","XAxis","YAxis","CartesianGrid","Tooltip","PropTypes","getTimestampFirstDayOfKey","datetype","date","Date","setDate","Math","round","Number","valueOf","setMonth","getDateTime","value","undefined","timestamp","year","getFullYear","month","getMonth","toString","length","toLocaleDateString","DashChart","dataProvider","data","setData","loading","setLoading","error","setError","sort","field","order","pagination","page","perPage","then","total","catch","chartData","preDate","map","answer","report_timestamp","selDate","Notifications","name","top","right","bottom","left","propTypes","string","isRequired"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useDataProvider, Loading, Error} from 'react-admin';\nimport { ResponsiveContainer, AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip} from 'recharts';\nimport PropTypes from 'prop-types';\n\nfunction getTimestampFirstDayOfKey(datetype) {\n    var date = new Date();\n    date.setDate(1);\n    if (datetype === \"month\") {\n        return Math.round(Number(date.valueOf() / 1000));\n    } else {\n        date.setMonth(0);\n        return Math.round(Number(date.valueOf() / 1000));\n    }\n}\n\nconst getDateTime = (value, datetype) => {\n    if (value === undefined) {\n        return \"\";\n    } else {\n        const timestamp = new Date(value === undefined ? new Date() : value * 1000);\n        var year = timestamp.getFullYear();\n        var month = (1 + timestamp.getMonth()).toString();\n        month = month.length > 1 ? month : '0' + month;\n        \n        // return timestamp.toLocaleString();\n        if (datetype === \"month\")\n            return timestamp.toLocaleDateString();\n        else \n            return month + \"/\" + year;\n    }\n};\n\nconst DashChart = ({ datetype }) => {\n\n    const dataProvider = useDataProvider();\n    const [data, setData] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState();\n\n    useEffect(() => {\n\n        dataProvider('GET_LIST', 'notifications', {\n            sort: { field: 'report_timestamp', order: 'ASC' },\n            pagination: { page: 1, perPage: 10000000 },\n        })\n            .then(({ data, total }) => {\n                setData(data);              \n                setLoading(false);\n            })\n            .catch(error => {\n                setError(error);\n                setLoading(false);\n            })\n    }, []);\n\n    var chartData = [];\n    if (loading) return <Loading />;\n    if (error) return <Error />;\n\n    var preDate = \"\"\n    data.map(async answer => {\n        if (!data || data.length === 0) {\n            return;\n        }\n\n        if (answer.report_timestamp < getTimestampFirstDayOfKey(datetype)) {\n            return;\n        }\n\n        const selDate = getDateTime(answer.report_timestamp, datetype);\n\n        if (preDate === selDate) {\n            chartData[chartData.length - 1].Notifications += 1;\n        } else {\n            chartData[chartData.length] = {\n                name: selDate,\n                Notifications  : 1\n            };\n            preDate = selDate;\n        }\n    });\n\n    return (\n        <ResponsiveContainer height={250} width='99%'>\n            <AreaChart \n            // width={500} height={400} \n            data={chartData} margin={{ top: 50, right: 20, bottom: 20, left: 20 }}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis dataKey=\"name\" />\n                <YAxis />\n                <Tooltip />\n                <Area type=\"monotone\" dataKey=\"Notifications\" stroke=\"#8884d8\" fill=\"#8884d8\" />\n            </AreaChart>\n        </ResponsiveContainer>\n    );\n}\n\nDashChart.propTypes = {\n    datetype: PropTypes.string.isRequired,\n};\n\nexport default DashChart;"]},"metadata":{},"sourceType":"module"}